{"version":3,"sources":["../src/baseActLoader.js"],"names":["BaseActLoader","moduleLoader","convention","path","_moduleLoader","_convention","_path","lastAct","suiteModulePath","lastActType","joinPath","join","dirname","baseActPath","load","getSuiteBasePath","act","base","_isDefinedInOwnFile","undefined","getActBasePath"],"mappings":";;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;;;;;IAEqBA,a;AACjB,6BAEqB;AAAA,YAFTC,YAES,uEAFM,4BAEN;AAAA,YADjBC,UACiB,uEADJ,0BACI;AAAA,YAAjBC,IAAiB;;AAAA;;AACjB,aAAKC,aAAL,GAAqBH,YAArB;AACA,aAAKI,WAAL,GAAmBH,UAAnB;AACA,aAAKI,KAAL,GAAaH,IAAb;AACH;;;;qCAEYI,O,EAASC,e,EAAiB;AACnC,gBAAIC,qBAAqBF,OAArB,yCAAqBA,OAArB,CAAJ;AACA,gBAAIE,gBAAgB,UAApB,EAAgC;AAC5B,uBAAOF,OAAP;AAEH,aAHD,MAGO,IAAIE,gBAAgB,QAApB,EAA8B;;AAEjC,oBAAIC,WAAW,KAAKJ,KAAL,CAAWK,IAA1B;AAAA,oBACIC,UAAU,KAAKN,KAAL,CAAWM,OADzB;;AAGA,oBAAIC,cAAcH,SAASE,QAAQJ,eAAR,CAAT,EAAmCD,OAAnC,CAAlB;;AAEA,uBAAO,KAAKH,aAAL,CAAmBU,IAAnB,CAAwBD,WAAxB,CAAP;AAEH,aATM,MASA;;AAEH,oBAAIA,eAAc,KAAKR,WAAL,CAAiBU,gBAAjB,CAAkCP,eAAlC,CAAlB;;AAEA,uBAAO,KAAKJ,aAAL,CAAmBU,IAAnB,CAAwBD,YAAxB,CAAP;AACH;AACJ;;;mCAGUG,G,EAAK;AACZ,gBAAIA,IAAIC,IAAR,EAAc;AACV,oBAAIP,WAAW,KAAKJ,KAAL,CAAWK,IAA1B;AAAA,oBACIC,UAAU,KAAKN,KAAL,CAAWM,OADzB;;AAGA,oBAAIC,cAAcH,SAASE,QAAQI,IAAIb,IAAZ,CAAT,EAA4Ba,IAAIC,IAAhC,CAAlB;;AAEA,uBAAO,KAAKb,aAAL,CAAmBU,IAAnB,CAAwBD,WAAxB,CAAP;AAEH,aARD,MAQO,IAAI,CAAC,KAAKK,mBAAL,CAAyBF,GAAzB,CAAL,EAAoC;AACvC,uBAAOG,SAAP;AACH,aAFM,MAEA;AACH,oBAAIN,gBAAc,KAAKR,WAAL,CAAiBe,cAAjB,CAAgCJ,IAAIb,IAApC,CAAlB;AACA,oBAAIU,aAAJ,EAAiB;AACb,2BAAO,KAAKT,aAAL,CAAmBU,IAAnB,CAAwBD,aAAxB,CAAP;AACP;AACJ;;;4CAEmBG,G,EAAK;AACrB,mBAAO,CAAC,CAACA,IAAIb,IAAb;AACH;;;;;;kBApDgBH,a","file":"baseActLoader.js","sourcesContent":["import ModuleLoader from './moduleLoader';\nimport Convention from './convention';\nimport realPath from 'path';\n\nexport default class BaseActLoader {\n    constructor(moduleLoader = new ModuleLoader(),\n        convention = new Convention(),\n        path = realPath) {\n        this._moduleLoader = moduleLoader;\n        this._convention = convention;\n        this._path = path;\n    }\n\n    loadForSuite(lastAct, suiteModulePath) {\n        let lastActType = typeof lastAct;\n        if (lastActType === 'function') {\n            return lastAct;\n\n        } else if (lastActType === 'string') {\n\n            let joinPath = this._path.join,\n                dirname = this._path.dirname;\n\n            let baseActPath = joinPath(dirname(suiteModulePath), lastAct);\n\n            return this._moduleLoader.load(baseActPath);\n\n        } else {\n\n            let baseActPath = this._convention.getSuiteBasePath(suiteModulePath);\n\n            return this._moduleLoader.load(baseActPath);\n        }\n    }\n\n\n    loadForAct(act) {\n        if (act.base) {\n            let joinPath = this._path.join,\n                dirname = this._path.dirname;\n\n            let baseActPath = joinPath(dirname(act.path), act.base);\n\n            return this._moduleLoader.load(baseActPath);\n\n        } else if (!this._isDefinedInOwnFile(act)) {\n            return undefined;\n        } else {\n            let baseActPath = this._convention.getActBasePath(act.path);\n            if (baseActPath) //FIXME not tested\n                return this._moduleLoader.load(baseActPath);\n        }\n    }\n\n    _isDefinedInOwnFile(act) {\n        return !!act.path;\n    }\n}\n"]}